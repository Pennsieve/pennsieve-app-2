<link rel="import" href="../../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../../bower_components/iron-flex-layout/iron-flex-layout.html">

<link rel="import" href="../../shared/item-icon-behavior.html">

<link rel="import" href="../../../../vendor-scripts.html">

<link rel="import" href="bf-latest-packages-styles.html">
<link rel="import" href="../../../../styles/blackfynn/icons.html">
<link rel="import" href="../../../../styles/blackfynn/main.html">
<link rel="import" href="../../../../styles/blackfynn/data-item.html">

<!--
`<bf-latest-package-item>` is a component to display information about a package

    <bf-latest-package-item item="[[item]]"></bf-latest-package-item>

@element bf-latest-package-item
-->

<dom-module id="bf-latest-package-item">

  <template>
    <style include="blackfynn-main-styles"></style>
    <style include="bf-data-item-styles"></style>
    <style include="bf-latest-packages-styles"></style>
    <style>
      :host {
        border-bottom: 1px solid #ececec;
        display: block;
        padding: 9px 20px;
        @apply(--layout-horizontal);
        @apply(--layout-center);
      }
      .icon-item {
        height: 24px;
        margin-right: 9px;
        width: 24px;
      }
      .column-name a {
        text-decoration: none;
      }
    </style>

    <div class="column column-name">
      <img src$="[[_computeIcon(item)]]"></img> -->
      <a href="#" on-tap="openItem">[[item.name]]</a>
    </div>
    <div class="column column-type">[[item.type]]</div>
    <div class="column column-updated-at">[[date]]</div>

  </template>

  <script>

    Polymer({
      is: 'bf-latest-package-item',

      behaviors: [
        Blackfynn.ItemIconBehavior
      ],

      properties: {
        item: {
          type: Object,
          value: function() {
            return {};
          }
        },
        /**
         * Proxy concepts
         */
        itemIcon: {
          type: String,
          computed: '_computeIcon(item.type)'
        },
        date: {
          type: String,
          computed: '_computeDate(item.createdAt)'
        }
      },

      /**
       * Compute date
       * @param {String} timestamp
       * @returns {String}
       */
      _computeDate: function(timestamp) {
        const _timestamp = R.defaultTo('', timestamp);

        if(_timestamp) {
          return moment(_timestamp).utc().format('M/D/YYYY h:ma');
        } else {
          return timestamp;
        }
      },

      /**
       * @event open-package
       * Fire an event to open a package
       */
      openItem: function() {
        this.fire('get-package', {
          id: this.get('item.id')
        });
      }

    });

  </script>

</dom-module>

<link rel="import" href="../../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../../bower_components/paper-button/paper-button.html">

<link rel="import" href="../../shared/bf-input/bf-input.html">
<link rel="import" href="../../shared/bf-select-menu/bf-select-menu.html">
<link rel="import" href="../bf-dialog/bf-dialog.html">

<link rel="import" href="../../../../styles/blackfynn/icons.html">
<link rel="import" href="../../../../styles/blackfynn/main.html">

<!--

-->
<dom-module id="bf-layer-window">

  <template>
    <style include="blackfynn-main-styles"></style>
    <style>
      h2 {
        margin: 20px 30px 30px 30px;
      }
      .cancel {
        margin-right: 10px;
      }
    </style>

    <bf-dialog id="dialog" opened="{{opened}}" processing="[[processing]]">
      <h2 slot="heading">[[_heading]]</h2>

      <div slot="body">
        <bf-input
          label="Layer Name"
          required
          placeholder="Add a Layer Name"
          value="{{layer.name}}"
          rows="2"></bf-input>
        <div class="select-wrapper">
          <bf-select-menu
            id="layerSelect"
            selected-value="{{layer.hexColor}}"
            items="[[layerColors]]"></bf-select-menu>
        </div>
      </div>

      <div slot="buttons">
        <paper-button
          class="cancel"
          noink
          dialog-dismiss
          on-tap="handleFormCancel">Cancel</paper-button>
        <paper-button
          class="save"
          noink
          dialog-confirm
          on-tap="handleFormSubmit">Save</paper-button>
      </div>
    </bf-dialog>
  </template>

  <script>
    Polymer({
      is: 'bf-layer-window',

      properties: {
        /**
         * Layer
         */
        layer: {
          type: Object,
          value: function() {
            return {
              name: '',
              color: ''
            }
          }
        },
        /**
        * Boolean to check if user is creating or editing a layer
        */
        isCreating: {
          type: Boolean,
          value: true
        },
        /**
        * List of color options
        */
        layerColors: {
          type: Array,
          value: function() {
            return [
              {
                label: 'Green',
                value: '#18BA62',
                iconBgColor: '#18BA62'
              },
              {
                label: 'Gold',
                value: '#FFBC27',
                iconBgColor: '#FFBC27'
              },
              {
                label: 'Red',
                value: '#E94B4B',
                iconBgColor: '#E94B4B'
              },
              {
                label: 'Light Blue',
                value: '#2760FF',
                iconBgColor: '#2760FF'
              },
              {
                label: 'Magenta',
                value: '#FF4FFF',
                iconBgColor: '#FF4FFF'
              },
              {
                label: 'Cyan',
                value: '#50FFFF',
                iconBgColor: '#50FFFF'
              },
              {
                label: 'Yellow',
                value: '#FFFF4E',
                iconBgColor: '#FFFF4E'
              },
              {
                label: 'Purple',
                value: '#512BAF',
                iconBgColor: '#512BAF'
              },
              {
                label: 'Lavendar',
                value: '#8A6ECF',
                iconBgColor: '#8A6ECF'
              },
              {
                label: 'Teal',
                value: '#389BAD',
                iconBgColor: '#389BAD'
              },
              {
                label: 'Dark Green',
                value: '#187D46',
                iconBgColor: '#187D46'
              },
              {
                label: 'Brick Red',
                value: '#B12800',
                iconBgColor: '#B12800'
              },
              {
                label: 'Dark Blue',
                value: '#0C2475',
                iconBgColor: '#0C2475'
              },
              {
                label: 'Bright Orange',
                value: '#FF5321',
                iconBgColor: '#FF5321'
              },
              {
                label: 'Pink',
                value: '#FF99CC',
                iconBgColor: '#FF99CC'
              },
              {
                label: 'Tan',
                value: '#DCC180',
                iconBgColor: '#DCC180'
              },
              {
                label: 'Medium Blue',
                value: '#0D4EFF',
                iconBgColor: '#0D4EFF'
              },
              {
                label: 'Orange',
                value: '#FF6C21',
                iconBgColor: '#FF6C21'
              },
              {
                label: 'Black',
                value: '#000000',
                iconBgColor: '#000000'
              },
              {
                label: 'Gray',
                value: '#9B9B9B',
                iconBgColor: '#9B9B9B'
              },
              {
                label: 'Lime',
                value: '#00FF00',
                iconBgColor: '#00FF00'
              },
              {
                label: 'Salmon',
                value: '#FA8072',
                iconBgColor: '#FA8072'
              },
              {
                label: 'Olive',
                value: '#808000',
                iconBgColor: '#808000'
              },
              {
                label: 'Sienna',
                value: '#A0522D',
                iconBgColor: '#A0522D'
              }
            ]
          }
        },
        selectedLayerColor: {
          type: String
        },
        /**
         * If the request is being processed
         */
         processing: {
          type: Boolean,
          value: false
        },
        /**
         * If the window is open
         */
         opened: {
          type: Boolean,
          value: false
        },
        /**
        * Compute heading value
        */
        _heading: {
          type: String,
          computed: '_computeHeading(isCreating)'
        },
      },

      setColorByIndex: function(index) {
        this.set('layer.hexColor', this.layerColors[index].value)
      },

      /**
      * XHR Request handler
      */
      handleFormSubmit: function(evt) {
        const { isCreating, layer } = this
        layer.color = this.$.layerSelect.selectedValue

        if (isCreating) {
          this.fire('create-layer', { layer })
        } else {
          this.fire('edit-layer', { layer })
        }
      },

      /**
      * Cancel layer creation / update
      */
      handleFormCancel: function() {
        this.$.dialog.close()
      },

      /**
       * Compute heading
       * @param {Boolean} isCreating
       * @returns {String}
       */
       _computeHeading: function(isCreating) {
         return this.isCreating ? 'Create Layer' : 'Edit Layer';
      },

    });
  </script>

</dom-module>

<!doctype html>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<html>
<head>

  <title>bf-share-item tests</title>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">

  <script src="../../../../../../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>

  <script src="../../../../../../../bower_components/web-component-tester/browser.js"></script>
  <script src="../../../../../../../bower_components/iron-test-helpers/test-helpers.js"></script>
  <script src="../../../../../../../bower_components/iron-test-helpers/mock-interactions.js"></script>

  <link rel="import" href="../bf-share-item.html">
  <link rel="import" href="letters-only.html">

</head>
<body>



  <test-fixture id="units">
    <template>
      <bf-share-item>
      </bf-share-item>
    </template>
  </test-fixture>
  <letters-only></letters-only>

  <test-fixture id="basic">
    <template is="dom-template">
      <bf-share-item id="basicTest" cur-package={{content}}>
      </bf-share-item>
    </template>
  </test-fixture>

  <script>

    suite('basic', function() {
     let component;
     const data1 =
      {"content": {
        "name":         "Fantastic Data",
        "id":           "id:xxx",
        "packageType":  "DataSet",
        "state":        "READY"
        }
      };

     setup(function () {

       component = fixture('basic', data1);
      //component = fixture('basic', data1);

      component.open();
     })

     test('displays package name', function () {
       assert.equal(component.querySelector('h2').textContent, 'Share Fantastic Data')
     })

     test('private view is visible view', function () {

       const privateDescText = 'Only you can see this dataset right now. Invite other people or change the settings to start sharing.';
       const orgDescText = 'This dataset is shared with your entire organization. You can the settings to make it private or shared with select people.'

       // Should be click...
       component._setActiveView('private');

       assert.equal(component.querySelectorAll('section').length, 1); // There is only one descriptive section
       assert.equal(component.querySelector('section').textContent.trim(), privateDescText);
       assert.notEqual(component.querySelector('section').textContent.trim(), orgDescText);
       // Test:
       // 1) Click "Private - Only you can access this" link
       // 2) Verify you see the desc text paragraph
       // 3) Verify you cannot see the org text
//
       //var el = Polymer.dom(component.root).querySelector('section');

       //assert.equal(el.content, "Only you can see this dataset");


       // And the desc text is like...
       // "Only you can see this dataset right now. Invite other people or change the settings to start sharing."
       // Which might be useful to determine if you're seeing the section a:352

     });

       // Polymer.dom(component.root).querySelector('button').click()
       // asser.equal(component.isWaiting, true)
    //  test('fffff', function (done) {
    //    setTimeout(function () {
    //      done();
    //    }, 1000)
     //
    //  });

    });

    suite('active views unit tests', function () {
      let component;

      setup(function () {
        component = fixture('units');
      })

      test('set and get active view', function () {
        //var activeView = component._getActiveView();
        component._setActiveView("organization");
        assert.equal(component._getActiveView(), "organization");
      })

      test('set and is active view', function () {
        //var activeView = component._getActiveView();
        component._setActiveView("organization");
        assert.equal(component._isActiveView("organization"), true);
      })

      test('set nonexistent view', function () {
        //var activeView = component._getActiveView();
        component._setActiveView("organization");

        component._setActiveView("cookie-party");
        assert.equal(component._isActiveView("cookie-party"), false);

        assert.equal(component._getActiveView(), 'organization');
        assert.equal(component._isActiveView("organization"), true);
      })
    })

  </script>

</body>
</html>

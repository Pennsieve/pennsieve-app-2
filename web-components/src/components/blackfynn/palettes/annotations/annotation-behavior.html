<link rel="import" href="../../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../vendor-scripts.html">

<script>
  /**
  * @polymerBehavior
  */
  BlackfynnAnnotationBehavior = {
    properties: {
      isAttached: {
        type: Boolean,
        value: false
      }
    },

    /**
     * computes title of annotation
     * @param {Object} item
     * @returns {String}
     */
     _computeAnnotationTitle(item) {
      let title = 'Untitled';
      if (item.description && item.description.length > 0) {
        title = item.description;
      } else if (item.label && item.label.length > 0) {
        title = item.label;
      }
      return title;
    },

    /**
     * computes duration of event; converts microseconds to unit of time
     * @param {String} duration
     * @returns {String}
     */
     _computeDuration: function(duration = 0) {
      const milliseconds = Math.floor(duration / 1000);
      return milliseconds > 0 ? `${moment.duration(milliseconds, 'seconds').seconds()} Seconds` : '';
    },

    /**
     * computes date from timestamp of annotation
     * @param {String} timestamp
     * @returns {String}
     */
    _computeDate: function(timestamp) {
      return moment(timestamp).format('MMMM D, YYYY');
    },

    /**
     * computes time from timestamp of annotation
     * @param {String} timestamp
     * @returns {String}
     */
    _computeTime: function(timestamp) {
      return moment(timestamp).format('h:mm:ss A');
    },

    /**
     * computes whether or not the user is owner of the annotation
     * @param {String} profile
     * @param {String} anOwner
     * @returns {Boolean}
     */
    _computeOwner: function(profile, anOwner) {
      return profile === anOwner;
    },

    /**
     * computes the user's fullname
     * @param {String} id
     * @param {Array} orgMembers
     * @returns {String}
     */
    _computeUser: function(id, orgMembers) {
      const _orgMembers = orgMembers.base
      return this.getUserName(id, _orgMembers)
    },

    /**
     * computes the user's fullname
     * @param {String} id
     * @param {Object} userMap
     * @returns {String}
     */
    getUserName: (id, userMap) => R.compose(
      R.trim,
      R.join(' '),
      R.props(['firstName', 'lastName']),
      R.defaultTo({}),
      R.find(R.propEq('id', id))
    )(userMap)

  }
</script>

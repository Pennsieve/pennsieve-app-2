<link rel="import" href="../../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../../bower_components/iron-flex-layout/iron-flex-layout.html">

<link rel="import" href="../../palettes/bf-file-browser/bf-file-browser.html">
<link rel="import" href="../../palettes/annotations/bf-annotations-list.html">
<link rel="import" href="../../palettes/bf-channels/bf-channel-list.html">
<link rel="import" href="../info-panel.html">
<link rel="import" href="../../palettes/bf-palette-discussion/bf-palette-discussion.html">
<link rel="import" href="../../palettes/bf-palette-navigator/bf-palette-navigator.html">
<link rel="import" href="../../state/bf-state-aware-behavior.html">

<link rel="import" href="../../../../styles/blackfynn/main.html">

<dom-module id="bf-viewer-side-panel">

  <template>
    <style include="blackfynn-main-styles"></style>
    <style type="text/css">
      :host {
        background: #f7f7f7;
        border-left: 1px solid $gray_2;
        display: none;
        height: 100%;
        width: 100%;
        max-width: 320px;
      }
      :host([open]) {
        @apply(--layout-vertical);
      }
    </style>

    <blackfynn-data-info-panel
      id="metaPanel"
      hidden$="[[!_isView('infoPanel', state.viewer.sidePanel.view)]]"
      api="[[api]]"
      user="[[user]]"
      profile="[[profile]]"
      item="[[activeViewer.data]]"
      item-id="[[activeViewer.data.id]]"
      active-organization="[[activeOrganization]]"></blackfynn-data-info-panel>

    <bf-palette-discussion
      id="discussions"
      hidden$="[[!_isView('discussion', state.viewer.sidePanel.view)]]"
      active-viewer="[[activeViewer]]"></bf-palette-discussion>

    <bf-file-browser
      id="fileBrowser"
      hidden$="[[!_isView('fileBrowser', state.viewer.sidePanel.view)]]"
      dataset="[[dataset]]"
      cur-package="[[curPackage]]"
      active-organization="[[activeOrganization]]"
      parent-id="[[parentId]]"></bf-file-browser>

    <bf-annotations-list
      id="annotationsList"
      hidden$="[[!_isView('annotations', state.viewer.sidePanel.view)]]"
      item="[[data]]"
      item-id="[[data.content.id]]"
      profile="[[profile]]"
      active-viewer="[[activeViewer]]"
      layers="[[activeViewer.annLayers]]"></bf-annotations-list>

    <bf-channel-list
      id="channelList"
      hidden$="[[!_isView('channels', state.viewer.sidePanel.view)]]"
      item="[[data]]"
      active-viewer="[[activeViewer]]"
      openOnLoad=true></bf-channel-list>

    <bf-palette-navigator
      id="navigator"
      is-mpp-visible="[[isMppVisible]]"
      hidden$="[[!_isView('navigator', state.viewer.sidePanel.view)]]"
      active-viewer="[[activeViewer]]"></bf-palette-navigator>

    <slot></slot>

  </template>

  <script>
    Polymer({
      is: 'bf-viewer-side-panel',

      behaviors: [
        StateAwareBehavior
      ],

      properties: {
        dataset: {
          type: Object,
          value: function() {
            return {}
          },
        }
      },

      _isView: function(view, currentView) {
        return view === currentView;
      }
    });

  </script>

</dom-module>
